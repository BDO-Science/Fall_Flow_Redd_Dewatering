mutate(across(everything(), ~ round(.x, 0)))
aug_sep_volume <- scens_with_rt_flows %>%
filter(Date <= paste0(yr,'-08-31')) %>%
summarize(across(-1, ~ sum(.x) * 1.983 / 1000)) %>%
mutate(across(everything(), ~ round(.x, 0)))
##########################
#creating summary table
##########################
#create column of measures
Metric <- data.frame(Measure = c("Avg Sept Flow (cfs)", "Avg Oct Flow (cfs)",
"Sept-Feb Total Volume (TAF)", "Aug-Sept Total Volume (TAF)", "Winter-run Redds Dewatered",
"Winter-run % Lost (current count)", paste0("Winter-run % Lost (mean expansion of ",exp_fac,")"),
"Winter-run Redds Dewatered (250 cfs buffer)", "Winter-run % Lost (250 cfs buffer)",
"Fall-run % Redds Dewatered"))
summary_table <- bind_rows(avg_flow_sep_oct, sep_feb_volume, aug_sep_volume,
wr_dewater, fall_dewater_for_table) %>%
bind_cols(Metric) %>%
select(ncol(.), 1:ncol(.))
##########################
#expansion factor
##########################
pop_tab <- data.frame(Expansion = seq(1,4,0.5)) %>%
mutate(Redds = round(reddCount*Expansion, 0),
"Dewatering Threshold (1%)" = Redds*0.01) %>%
rename("Expansion Factor" = Expansion,
"Total Redds" = Redds)
View(rt_flows)
View(scens_with_rt_flows)
ymax <- round_any(max(sces_with_rt_flows[2:3])+250, 500, f = ceiling)
#ymax <- round_any(max(reddsTable$ACTUAL.or.ESTIMATED..DEWATER.FLOW), 250, f = ceiling)
ymax <- zoo::round_any(max(sces_with_rt_flows[2:3])+250, 500, f = ceiling)
#ymax <- round_any(max(reddsTable$ACTUAL.or.ESTIMATED..DEWATER.FLOW), 250, f = ceiling)
ymax <- plyr::round_any(max(sces_with_rt_flows[2:3])+250, 500, f = ceiling)
#ymax <- round_any(max(reddsTable$ACTUAL.or.ESTIMATED..DEWATER.FLOW), 250, f = ceiling)
ymax <- plyr::round_any(max(scens_with_rt_flows[2:3])+250, 500, f = ceiling)
View(redds)
ymin <- round_any(min(redds$dewater_flow), 1000, f = floor)
ymin <- plyr::round_any(min(redds$dewater_flow), 1000, f = floor)
todays_date <- Sys.Date()
mid <- as.Date(paste0(yr,'-08-01')) + floor((todays_date - as.Date(paste0(yr,'-08-01')))/2)
redds_graph <- redds %>% group_by(emergence_date, status, dewater_flow) %>%
summarize(count = n())
View(redds_graph)
redds_graph <- redds %>% group_by(emergence_date, status, dewater_flow) %>%
summarize(count = n()) %>%
mutate(status = factor(status,
levels = c('OK', 'EMERGED', 'DEWATER'),
labels = c('Re', 'Em', 'De')))
flows <- scens_with_rt_flows %>%
pivot_longer(names_to = Alts, value_to = Flow, -1) %>%
filter(date >= todays_date)
flows <- scens_with_rt_flows %>%
pivot_longer(names_to = Alts, values_to = Flow, -1) %>%
filter(date >= todays_date)
flows <- scens_with_rt_flows %>%
pivot_longer(names_to = 'Alts', values_to = 'Flow', -1) %>%
filter(date >= todays_date)
flows <- scens_with_rt_flows %>%
pivot_longer(names_to = 'Alts', values_to = 'Flow', -1)
View(flows)
flows <- scens_with_rt_flows %>%
pivot_longer(names_to = 'Alts', values_to = 'Flow', -1) %>%
filter(Date >= todays_date)
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), size = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), size = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = Date, y = Flow, fill = status), shape = 21, size = 5, color = 'black') +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), size = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), size = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status), shape = 21, size = 5, color = 'black') +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), size = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), size = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_jitter(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status), shape = 21, size = 5, color = 'black') +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status') +
theme(legend.position = 'bottom',
legend.text = element_text(size = 12),
axis.text = element_text(size = 10),
axis.title = element_text(size = 12),
legend.title = element_text(size = 14),
legend.key.size = unit(0.3, 'cm')) +
scale_fill_manual(values = c('lightgrey', 'steelblue3', 'darkorange')) +
annotate(geom = 'rect', xmin = as.Date(paste0(yr,'-08-01')), xmax = max(todays_date),
ymin = 3000, ymax = max(allflows$Flow) + 100, fill = 'darkgrey', color = 'black', alpha = 0.2, linetype = 'dotted') +
annotate(geom = 'text', x = (mid + 0.5), y = max(allflows$Flow) + 400, size = 3.5,
fontface = 'italic', label = 'Actual Flows') +
annotate(geom = 'text', x = as.Date('2023-09-03'), y = 9350, size = 3, label = 'KWK') +
annotate(geom = 'text', x = as.Date('2023-09-03'), y = 7750, size = 3, label = 'KES')
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), size = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), size = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_jitter(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status), shape = 21, size = 5, color = 'black') +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), size = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), size = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 5, color = 'black',
position = 'dodge') +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), size = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), size = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 5, color = 'black',
position = position_dodge(width = 1)) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), size = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), size = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 5, color = 'black',
position = position_dodge(width = 2)) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), size = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), size = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 5, color = 'black',
position = position_dodge(width = 4)) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), size = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), size = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 5, color = 'black',
position = position_dodge(width = .1)) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 5, color = 'black',
position = position_jitter(width = 1, height = 0)) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 5, color = 'black',
#position = position_jitter(width = 1, height = 0)
) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 5, color = 'black',
position = position_jitter(width = 1, height = 0)
) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 5, color = 'black',
position = position_jitter(width = -1, height = 0)
) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 5, color = 'black',
position = position_jitter(width = 2, height = 0)
) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 5, color = 'black',
position = position_jitter(width = 1, height = 0)
) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
library(ggrepel)
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_count(redds, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 5, color = 'black',
) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 5, color = 'black',
) +
geom_text(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, label = count)) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 6, color = 'black',
) +
geom_text(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, label = count)) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 6, color = 'black',
) +
geom_text(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, label = count)) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status') +
theme_bw()
theme(legend.position = 'bottom',
legend.text = element_text(size = 12),
axis.text = element_text(size = 10),
axis.title = element_text(size = 12),
legend.title = element_text(size = 14),
legend.key.size = unit(0.3, 'cm'))
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 6, color = 'black',
) +
geom_text(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, label = count)) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status') +
theme_bw() +
theme(legend.position = 'bottom',
legend.text = element_text(size = 12),
axis.text = element_text(size = 10),
axis.title = element_text(size = 12),
legend.title = element_text(size = 14),
legend.key.size = unit(0.3, 'cm'))
redds_graph
redds_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 6, color = 'black',
) +
geom_text(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, label = count)) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status') +
theme_bw() +
theme(legend.position = 'bottom',
legend.text = element_text(size = 12),
axis.text = element_text(size = 10),
axis.title = element_text(size = 12),
legend.title = element_text(size = 14),
legend.key.size = unit(0.3, 'cm'))
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 6, color = 'black',
) +
geom_text(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, label = count)) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status') +
theme_bw() +
theme(legend.position = 'bottom',
legend.text = element_text(size = 12),
axis.text = element_text(size = 10),
axis.title = element_text(size = 12),
legend.title = element_text(size = 14),
legend.key.size = unit(0.3, 'cm')) +
scale_fill_viridis_d() +
annotate(geom = 'rect', xmin = as.Date(paste0(yr,'-08-01')), xmax = max(todays_date),
ymin = 3000, ymax = max(allflows$Flow) + 100, fill = 'darkgrey', color = 'black', alpha = 0.2, linetype = 'dotted') +
annotate(geom = 'text', x = (mid + 0.5), y = max(allflows$Flow) + 400, size = 3.5,
fontface = 'italic', label = 'Actual Flows') +
annotate(geom = 'text', x = as.Date('2023-09-03'), y = 9350, size = 3, label = 'KWK') +
annotate(geom = 'text', x = as.Date('2023-09-03'), y = 7750, size = 3, label = 'KES')
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 6, color = 'black',
) +
geom_text(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, label = count)) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status') +
theme_bw() +
theme(legend.position = 'bottom',
legend.text = element_text(size = 12),
axis.text = element_text(size = 10),
axis.title = element_text(size = 12),
legend.title = element_text(size = 14),
legend.key.size = unit(0.3, 'cm')) +
scale_fill_viridis_d() +
annotate(geom = 'rect', xmin = as.Date(paste0(yr,'-08-01')), xmax = max(todays_date),
ymin = 3000, ymax = max(rt_flows$Flow) + 100, fill = 'darkgrey', color = 'black', alpha = 0.2, linetype = 'dotted') +
annotate(geom = 'text', x = (mid + 0.5), y = max(rt_flows$Flow) + 400, size = 3.5,
fontface = 'italic', label = 'Actual Flows') +
#annotate(geom = 'text', x = as.Date('2023-09-03'), y = 9350, size = 3, label = 'KWK') +
#annotate(geom = 'text', x = as.Date('2023-09-03'), y = 7750, size = 3, label = 'KES')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 6, color = 'black',
) +
geom_text(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, label = count)) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status') +
theme_bw() +
theme(legend.position = 'bottom',
legend.text = element_text(size = 12),
axis.text = element_text(size = 10),
axis.title = element_text(size = 12),
legend.title = element_text(size = 14),
legend.key.size = unit(0.3, 'cm')) +
scale_fill_viridis_d() +
annotate(geom = 'rect', xmin = as.Date(paste0(yr,'-08-01')), xmax = max(todays_date),
ymin = 3000, ymax = max(rt_flows$flow) + 100, fill = 'darkgrey', color = 'black', alpha = 0.2, linetype = 'dotted') +
annotate(geom = 'text', x = (mid + 0.5), y = max(rt_flows$flow) + 400, size = 3.5,
fontface = 'italic', label = 'Actual Flows') +
#annotate(geom = 'text', x = as.Date('2023-09-03'), y = 9350, size = 3, label = 'KWK') +
#annotate(geom = 'text', x = as.Date('2023-09-03'), y = 7750, size = 3, label = 'KES')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 6, color = 'black',
) +
geom_text(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, label = count)) +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status') +
theme_bw() +
theme(legend.position = 'bottom',
legend.text = element_text(size = 12),
axis.text = element_text(size = 10),
axis.title = element_text(size = 12),
legend.title = element_text(size = 14),
legend.key.size = unit(0.3, 'cm')) +
scale_fill_viridis_d()
#annotate(geom = 'rect', xmin = as.Date(paste0(yr,'-08-01')), xmax = max(todays_date),
#ymin = 3000, ymax = max(rt_flows$flow) + 100, fill = 'darkgrey', color = 'black', alpha = 0.2, linetype = 'dotted') +
#annotate(geom = 'text', x = (mid + 0.5), y = max(rt_flows$flow) + 400, size = 3.5,
#fontface = 'italic', label = 'Actual Flows') +
#annotate(geom = 'text', x = as.Date('2023-09-03'), y = 9350, size = 3, label = 'KWK') +
#annotate(geom = 'text', x = as.Date('2023-09-03'), y = 7750, size = 3, label = 'KES')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 6, color = 'black',
) +
geom_text(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, label = count),
color = 'white') +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status') +
theme_bw() +
theme(legend.position = 'bottom',
legend.text = element_text(size = 12),
axis.text = element_text(size = 10),
axis.title = element_text(size = 12),
legend.title = element_text(size = 14),
legend.key.size = unit(0.3, 'cm')) +
scale_fill_viridis_d()
#annotate(geom = 'rect', xmin = as.Date(paste0(yr,'-08-01')), xmax = max(todays_date),
#ymin = 3000, ymax = max(rt_flows$flow) + 100, fill = 'darkgrey', color = 'black', alpha = 0.2, linetype = 'dotted') +
#annotate(geom = 'text', x = (mid + 0.5), y = max(rt_flows$flow) + 400, size = 3.5,
#fontface = 'italic', label = 'Actual Flows') +
#annotate(geom = 'text', x = as.Date('2023-09-03'), y = 9350, size = 3, label = 'KWK') +
#annotate(geom = 'text', x = as.Date('2023-09-03'), y = 7750, size = 3, label = 'KES')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 6, color = 'black',
) +
geom_text(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, label = count),
color = 'white') +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status') +
theme_bw() +
theme(legend.position = 'bottom',
legend.text = element_text(size = 12),
axis.text = element_text(size = 10),
axis.title = element_text(size = 12),
legend.title = element_text(size = 14),
legend.key.size = unit(0.3, 'cm')) +
scale_fill_manual(values = c(Re = 'lightgrey', Em = 'steelblue3', De = 'darkorange'))
#annotate(geom = 'rect', xmin = as.Date(paste0(yr,'-08-01')), xmax = max(todays_date),
#ymin = 3000, ymax = max(rt_flows$flow) + 100, fill = 'darkgrey', color = 'black', alpha = 0.2, linetype = 'dotted') +
#annotate(geom = 'text', x = (mid + 0.5), y = max(rt_flows$flow) + 400, size = 3.5,
#fontface = 'italic', label = 'Actual Flows') +
#annotate(geom = 'text', x = as.Date('2023-09-03'), y = 9350, size = 3, label = 'KWK') +
#annotate(geom = 'text', x = as.Date('2023-09-03'), y = 7750, size = 3, label = 'KES')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 6, color = 'black',
) +
geom_text(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, label = count),
color = 'black') +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status') +
theme_bw() +
theme(legend.position = 'bottom',
legend.text = element_text(size = 12),
axis.text = element_text(size = 10),
axis.title = element_text(size = 12),
legend.title = element_text(size = 14),
legend.key.size = unit(0.3, 'cm')) +
scale_fill_manual(values = c(Re = 'lightgrey', Em = 'steelblue3', De = 'darkorange'))
#annotate(geom = 'rect', xmin = as.Date(paste0(yr,'-08-01')), xmax = max(todays_date),
#ymin = 3000, ymax = max(rt_flows$flow) + 100, fill = 'darkgrey', color = 'black', alpha = 0.2, linetype = 'dotted') +
#annotate(geom = 'text', x = (mid + 0.5), y = max(rt_flows$flow) + 400, size = 3.5,
#fontface = 'italic', label = 'Actual Flows') +
#annotate(geom = 'text', x = as.Date('2023-09-03'), y = 9350, size = 3, label = 'KWK') +
#annotate(geom = 'text', x = as.Date('2023-09-03'), y = 7750, size = 3, label = 'KES')
redd_graph
redd_graph <- ggplot() + geom_line(flows, mapping = aes(x = Date, y = Flow, color = Alts), linewidth = 0.75) +
geom_line(rt_flows, mapping = aes(x = date, y = flow, linetype = location), linewidth = 0.75) +
scale_linetype_discrete(guide = "none") +
geom_point(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, fill = status),
shape = 21, size = 6, color = 'black',
) +
geom_text(redds_graph, mapping = aes(x = emergence_date, y = dewater_flow, label = count),
color = 'black') +
ylim(ymin, ymax) +
xlim(min(as.Date(paste0(yr,'-08-01'))), (max(redds$emergence_date) + 5)) +
labs(x = 'Date', y = 'Flow (cfs)', fill = 'Redd Status') +
theme_bw() +
theme(legend.position = 'bottom',
legend.text = element_text(size = 12),
axis.text = element_text(size = 10),
axis.title = element_text(size = 14),
legend.title = element_text(size = 14),
legend.key.size = unit(0.3, 'cm')) +
scale_fill_manual(values = c(Re = 'lightgrey', Em = 'steelblue3', De = 'darkorange'))
#annotate(geom = 'rect', xmin = as.Date(paste0(yr,'-08-01')), xmax = max(todays_date),
#ymin = 3000, ymax = max(rt_flows$flow) + 100, fill = 'darkgrey', color = 'black', alpha = 0.2, linetype = 'dotted') +
#annotate(geom = 'text', x = (mid + 0.5), y = max(rt_flows$flow) + 400, size = 3.5,
#fontface = 'italic', label = 'Actual Flows') +
#annotate(geom = 'text', x = as.Date('2023-09-03'), y = 9350, size = 3, label = 'KWK') +
#annotate(geom = 'text', x = as.Date('2023-09-03'), y = 7750, size = 3, label = 'KES')
redd_graph
